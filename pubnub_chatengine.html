<!doctype html><html lang="en">
<head>    <meta charset="utf-8">    <title>PubNub ChatEngine</title>    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.5/css/bootstrap.min.css" integrity="sha384-AysaV+vQoT3kOAXZkl02PThvDr8HYKPZhNT5h/CXfBThSRXQ6jW5DO2ekP5ViFdi" crossorigin="anonymous">    <style type="text/css">    * {        margin: 0px;        padding: 0px;    }
    body {        margin: 30px auto;    }    </style></head>
<body>    <div class="container">        <div class="col-sm-6 offset-sm-3">            <div class="card">                <div class="card-header">                    Chat                </div>                <div class="card-block">                    <div class="log" id="chat-output"></div>                    <div class="input-group">                        <input type="text" class="form-control message" placeholder="Your Message..." id="chat-input" onkeypress="checkSubmit(event)">                        <span class="input-group-btn"><button class="btn btn-primary" type="submit" onclick="sendChat()">Send</button></span>                    </div>                </div>            </div>        </div>        <!--reference to chat engine api -->  <script src="../node_modules/chat-engine/dist/chat-engine.js" type="text/javascript"></script>        <!-- JavaScript file -->  <script type="text/javascript">  //assign current timestamp to variable        const now = new Date().getTime();        //assign username as user and timestamp  const username = ['user', now].join('-');        // assign form data from chat-input to variable   const textInput = document.getElementById('chat-input');  // assign form data from chat-output to variable        const textOutput = document.getElementById('chat-output');
          let sendChat = function() {}; // will be filled in when ChatEngine connects
  //  connect to the pubnub server using publish/subscribe keys, global channel        const ChatEngine = ChatEngineCore.create({            publishKey: 'pub-c-d8599c43-cecf-42ba-a72f-aa3b24653c2b',            subscribeKey: 'sub-c-6c6c021c-c4e2-11e7-9628-f616d8b03518'        }, {            globalChannel: 'chat-engine-demo-js',            debug: true        });
  //listen for any events, send them to console log        ChatEngine.onAny((a) => {            // console.log(a)        });
  //connect to the chat engine, pass username, username meta data, auth key to server        ChatEngine.connect(   username,    {signedOnTime: now},    'auth-key' + new Date().getTime()   );
  //pubnub will send ready event back to the script        ChatEngine.on('$.ready', (data) => {
   //when event message is received send data to console            data.me.direct.onAny((a) => {                console.log(a)            })
   //send message to chat             sendChat = function(e) {    //send message payload(format --> message header, text property = text: form_input)                ChatEngine.global.emit('message', {                    text: textInput.value                });    //change value of text input variable back to empty string                textInput.value = '';    //return false, inclear why false assumed to be due to failure exceptions                return false;            };      //function checks the keyboard key that was pressed to submit the form            checkSubmit = function(e) {    //if the enter key was pressed (keycode = 13), call the sendchat function                if (e.keyCode == 13) {                    sendChat();                }            }
   //Listens for message event on the global chat, message payload is received as argument            ChatEngine.global.on('message', (payload) => {    // creates paragraph element and sets equal to div variable                let div = document.createElement("p");    // add data to element: sender uuid and the text from the message payload                div.innerHTML = payload.sender.uuid + ': ' + payload.data.text;    //append the div with message data to the textOutput variable                textOutput.appendChild(div);            });        });        </script></body>
</html>
